var path = require('path')
var fs = require('fs')

var icon_listing = {
  load: function (file) { 

    
    function svg_items(file){

      let arr_svg_items = new Array;
      let svg_markup = fs.readFileSync(path.join('./app/assets/svg/'+file+'.svg'), 'utf8')
      
      svg_markup = svg_markup.replace(/id="([^"]*)/gim, function(match, p1, p2, offset, input_string){
        
        arr_svg_items.push({ icon: p1 });
      });

      return arr_svg_items;
    }

    var svg_list = new Array;

    var filenames = fs.readdirSync(path.join('./app/assets/svg/'), function(err, filenames) {
      return filenames;
    });

    filenames.forEach(function(filename) {
        
      if(filename != 'brand.svg' && filename != 'ui.svg'){
        
        filename = filename.replace('.svg','');

        svg_file = {
          file: filename,
          items: svg_items(filename)
        }
        
        svg_list.push(svg_file);
      }
    });
    
    icon_listing.iconlist = svg_list;
    icon_listing.uiicons = [{
      file: 'ui',
      items: svg_items('ui')
    }];

    icon_listing.rebrand_uiicons = [{
      file: 'rebrand-ui',
      items: svg_items('rebrand-ui')
    }];

    return icon_listing;
  }
};

module.exports = icon_listing